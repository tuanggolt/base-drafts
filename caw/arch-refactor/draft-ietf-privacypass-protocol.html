<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Privacy Pass Protocol Specification</title>
<meta content="SofÃ­a Celi" name="author">
<meta content="Alex Davidson" name="author">
<meta content="Armando Faz-Hernandez" name="author">
<meta content="
       This document specifies the Privacy Pass protocol. This protocol
provides anonymity-preserving authorization of clients to servers. In
particular, client re-authorization events cannot be linked to any
previous initial authorization. Privacy Pass is intended to be used as a
performant protocol in the application-layer. 
    " name="description">
<meta content="xml2rfc 3.11.1" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-privacypass-protocol" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.11.1
    Python 3.9.7
    appdirs 1.4.4
    ConfigArgParse 1.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.4
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 52.0.0
    six 1.16.0
-->
<link href="draft-ietf-privacypass-protocol.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines */
  line-height: 0;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow, svg + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
/* Trick: a prefix match works because only black and white are allowed */
svg [stroke="black"], svg [stroke^="#000"] {
  stroke: var(--text-color);
}
svg [stroke="white"], svg [stroke^="#fff"] {
  stroke: var(--background-color);
}
svg [fill="black"], svg [fill^="#000"], svg :not([fill]) {
  fill: var(--text-color);
}
svg [stroke="fill"], svg [fill^="#fff"] {
  fill: var(--background-color);
}
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">PP protocol</td>
<td class="right">December 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Celi, et al.</td>
<td class="center">Expires 20 June 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-privacypass-protocol</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-12-17" class="published">17 December 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-06-20">20 June 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Celi</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">A. Davidson</div>
<div class="org">LIP</div>
</div>
<div class="author">
      <div class="author-name">A. Faz-Hernandez</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Privacy Pass Protocol Specification</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies the Privacy Pass protocol. This protocol
provides anonymity-preserving authorization of clients to servers. In
particular, client re-authorization events cannot be linked to any
previous initial authorization. Privacy Pass is intended to be used as a
performant protocol in the application-layer.<a href="#section-abstract-1" class="pilcrow">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 20 June 2022.<a href="#section-boilerplate.1-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">â²</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.Â Â <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.Â Â <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.Â Â <a href="#name-background" class="xref">Background</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.Â Â <a href="#name-motivating-use-cases" class="xref">Motivating use-cases</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.Â Â <a href="#name-anonymity-and-security-guar" class="xref">Anonymity and security guarantees</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.Â Â <a href="#name-basic-assumptions" class="xref">Basic assumptions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.Â Â <a href="#name-protocol-description" class="xref">Protocol description</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.Â Â <a href="#name-server-setup" class="xref">Server setup</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.Â Â <a href="#name-client-setup" class="xref">Client setup</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.Â Â <a href="#name-issuance-phase" class="xref">Issuance phase</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.Â Â <a href="#name-redemption-phase" class="xref">Redemption phase</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="xref">4.4.1</a>.Â Â <a href="#name-client-info" class="xref">Client info</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="xref">4.4.2</a>.Â Â <a href="#name-double-spend-protection" class="xref">Double-spend protection</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.Â Â <a href="#name-handling-errors" class="xref">Handling errors</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.Â Â <a href="#name-functionality" class="xref">Functionality</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.Â Â <a href="#name-data-structures" class="xref">Data structures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.Â Â <a href="#name-ciphersuite" class="xref">Ciphersuite</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.Â Â <a href="#name-keys" class="xref">Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="xref">5.1.3</a>.Â Â <a href="#name-commitrequest" class="xref">CommitRequest</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="xref">5.1.4</a>.Â Â <a href="#name-commitresponse" class="xref">CommitResponse</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.5">
                    <p id="section-toc.1-1.5.2.1.2.5.1"><a href="#section-5.1.5" class="xref">5.1.5</a>.Â Â <a href="#name-issuanceinput" class="xref">IssuanceInput</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.6">
                    <p id="section-toc.1-1.5.2.1.2.6.1"><a href="#section-5.1.6" class="xref">5.1.6</a>.Â Â <a href="#name-issuanceresponse" class="xref">IssuanceResponse</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.7">
                    <p id="section-toc.1-1.5.2.1.2.7.1"><a href="#section-5.1.7" class="xref">5.1.7</a>.Â Â <a href="#name-redemptiontoken" class="xref">RedemptionToken</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.8">
                    <p id="section-toc.1-1.5.2.1.2.8.1"><a href="#section-5.1.8" class="xref">5.1.8</a>.Â Â <a href="#name-redemptionrequest" class="xref">RedemptionRequest</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.9">
                    <p id="section-toc.1-1.5.2.1.2.9.1"><a href="#section-5.1.9" class="xref">5.1.9</a>.Â Â <a href="#name-redemptionresponse" class="xref">RedemptionResponse</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.Â Â <a href="#name-api-functions" class="xref">API functions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.Â Â <a href="#name-prepare" class="xref">Prepare</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.Â Â <a href="#name-commit" class="xref">Commit</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="xref">5.2.3</a>.Â Â <a href="#name-generate" class="xref">Generate</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="xref">5.2.4</a>.Â Â <a href="#name-issue" class="xref">Issue</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.5">
                    <p id="section-toc.1-1.5.2.2.2.5.1"><a href="#section-5.2.5" class="xref">5.2.5</a>.Â Â <a href="#name-process" class="xref">Process</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.6">
                    <p id="section-toc.1-1.5.2.2.2.6.1"><a href="#section-5.2.6" class="xref">5.2.6</a>.Â Â <a href="#name-redeem" class="xref">Redeem</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.7">
                    <p id="section-toc.1-1.5.2.2.2.7.1"><a href="#section-5.2.7" class="xref">5.2.7</a>.Â Â <a href="#name-verify" class="xref">Verify</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.Â Â <a href="#name-error-types" class="xref">Error types</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.Â Â <a href="#name-security-considerations" class="xref">Security considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.Â Â <a href="#name-unlinkability" class="xref">Unlinkability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.Â Â <a href="#name-one-more-unforgeability" class="xref">One-more unforgeability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.Â Â <a href="#name-double-spend-protection-2" class="xref">Double-spend protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.Â Â <a href="#name-additional-token-metadata" class="xref">Additional token metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.Â Â <a href="#name-maximum-number-of-tokens-is" class="xref">Maximum number of tokens issued</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.Â Â <a href="#name-voprf-instantiation" class="xref">VOPRF instantiation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.Â Â <a href="#name-recommended-ciphersuites" class="xref">Recommended ciphersuites</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.Â Â <a href="#name-protocol-contexts" class="xref">Protocol contexts</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.Â Â <a href="#name-functionality-2" class="xref">Functionality</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="xref">7.3.1</a>.Â Â <a href="#name-generate-2" class="xref">Generate</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="xref">7.3.2</a>.Â Â <a href="#name-issue-2" class="xref">Issue</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a href="#section-7.3.3" class="xref">7.3.3</a>.Â Â <a href="#name-process-2" class="xref">Process</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.4">
                    <p id="section-toc.1-1.7.2.3.2.4.1"><a href="#section-7.3.4" class="xref">7.3.4</a>.Â Â <a href="#name-redeem-2" class="xref">Redeem</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.5">
                    <p id="section-toc.1-1.7.2.3.2.5.1"><a href="#section-7.3.5" class="xref">7.3.5</a>.Â Â <a href="#name-verify-2" class="xref">Verify</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.Â Â <a href="#name-security-justification" class="xref">Security justification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.Â Â <a href="#name-protocol-ciphersuites" class="xref">Protocol ciphersuites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.Â Â <a href="#name-ppoprf2" class="xref">PP(OPRF2)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.Â Â <a href="#name-ppoprf4" class="xref">PP(OPRF4)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.Â Â <a href="#name-ppoprf5" class="xref">PP(OPRF5)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.Â Â <a href="#name-extensions-framework-policy" class="xref">Extensions framework policy</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>.Â <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.Â Â <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.Â Â <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="xref">Appendix A</a>.Â Â <a href="#name-document-contributors" class="xref">Document contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">A common problem on the Internet is providing an effective mechanism for
servers to derive trust from clients that they interact with. Typically,
this can be done by providing some sort of authorization challenge to
the client. But this also negatively impacts the experience of clients
that regularly have to solve such challenges.<a href="#section-1-1" class="pilcrow">Â¶</a></p>
<p id="section-1-2">To mitigate accessibility issues, a client that correctly solves the
challenge can be provided with a cookie. This cookie can be presented
the next time the client interacts with the server, instead of
performing the challenge. However, this does not solve the problem of
reauthorization of clients across multiple domains. Using current tools,
providing some multi-domain authorization token would allow linking
client browsing patterns across those domains, and severely reduces
their online privacy.<a href="#section-1-2" class="pilcrow">Â¶</a></p>
<p id="section-1-3">The Privacy Pass protocol provides a set of cross-domain authorization
tokens that protect the client's anonymity in message exchanges with a
server. This allows clients to communicate an attestation of a
previously authenticated server action, without having to reauthenticate
manually. The tokens retain anonymity in the sense that the act of
revealing them cannot be linked back to the session where they were
initially issued.<a href="#section-1-3" class="pilcrow">Â¶</a></p>
<p id="section-1-4">This document lays out the generic description of the protocol, along
with the data and message formats. We detail an implementation of the
protocol functionality based on the description of a verifiable
oblivious pseudorandom function <span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span>.<a href="#section-1-4" class="pilcrow">Â¶</a></p>
<p id="section-1-5">This document DOES NOT cover the architectural framework required for
running and maintaining the Privacy Pass protocol in the Internet
setting. In addition, it DOES NOT cover the choices that are necessary
for ensuring that client privacy leaks do not occur. Both of these
considerations are covered in a separate document
<span>[<a href="#draft-davidson-pp-architecture" class="xref">draft-davidson-pp-architecture</a>]</span>. In addition,
<span>[<a href="#draft-svaldez-pp-http-api" class="xref">draft-svaldez-pp-http-api</a>]</span> provides an instantiation of this protocol
intended for the HTTP setting.<a href="#section-1-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-2-1" class="pilcrow">Â¶</a></p>
<p id="section-2-2">The following terms are used throughout this document.<a href="#section-2-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-3.1">Server: A service that provides the server-side functionality required
by the protocol. May be referred to as the issuer.<a href="#section-2-3.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-2-3.2">Client: An entity that seeks authorization from a server that supports
interactions in the Privacy Pass protocol.<a href="#section-2-3.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-2-3.3">Key: The secret key used by the server for authorizing client data.<a href="#section-2-3.3" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-2-4">We assume that all protocol messages are encoded into raw byte format
before being sent. We use the TLS presentation language <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> to
describe the structure of protocol data types and messages.<a href="#section-2-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="background">
<section id="section-3">
      <h2 id="name-background">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-background" class="section-name selfRef">Background</a>
      </h2>
<p id="section-3-1">We discuss the core motivation behind the protocol along with the
guarantees and assumptions that we make in this document.<a href="#section-3-1" class="pilcrow">Â¶</a></p>
<div id="motivating-use-cases">
<section id="section-3.1">
        <h3 id="name-motivating-use-cases">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-motivating-use-cases" class="section-name selfRef">Motivating use-cases</a>
        </h3>
<p id="section-3.1-1">The Privacy Pass protocol was originally developed to provide anonymous
authorization of Tor users. In particular, the protocol allows clients
to reveal authorization tokens that they have been issued without
linking the authorization to the actual issuance event. This means that
the tokens cannot be used to link the browsing patterns of clients that
reveal tokens.<a href="#section-3.1-1" class="pilcrow">Â¶</a></p>
<p id="section-3.1-2">Beyond these uses-cases, the Privacy Pass protocol is used in a number
of practical applications. See <span>[<a href="#DGSTV18" class="xref">DGSTV18</a>]</span>, <span>[<a href="#TrustTokenAPI" class="xref">TrustTokenAPI</a>]</span>,
<span>[<a href="#PrivateStorage" class="xref">PrivateStorage</a>]</span>, <span>[<a href="#OpenPrivacy" class="xref">OpenPrivacy</a>]</span>, and <span>[<a href="#Brave" class="xref">Brave</a>]</span> for examples.<a href="#section-3.1-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="anonymity-and-security-guarantees">
<section id="section-3.2">
        <h3 id="name-anonymity-and-security-guar">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-anonymity-and-security-guar" class="section-name selfRef">Anonymity and security guarantees</a>
        </h3>
<p id="section-3.2-1">Privacy Pass provides anonymity-preserving authorization tokens for
clients. Throughout this document, we use the terms "anonymous",
"anonymous-preserving" and "anonymity" to refer to the core security
guarantee of the protocol. Informally, this guarantee means that any
token issued by a server key and subsequently redeemed is
indistinguishable from any other token issued under the same key.<a href="#section-3.2-1" class="pilcrow">Â¶</a></p>
<p id="section-3.2-2">Privacy Pass also prohibits clients from forging tokens, as otherwise
the protocol would have little value as an authorization protocol.
Informally, this means any client that is issued <code>N</code> tokens under a
given server key cannot redeem more than <code>N</code> valid tokens.<a href="#section-3.2-2" class="pilcrow">Â¶</a></p>
<p id="section-3.2-3"><a href="#sec-reqs" class="xref">Section 6</a> elaborates on these protocol anonymity and security
requirements.<a href="#section-3.2-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="basic-assumptions">
<section id="section-3.3">
        <h3 id="name-basic-assumptions">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-basic-assumptions" class="section-name selfRef">Basic assumptions</a>
        </h3>
<p id="section-3.3-1">We make only a few minimal assumptions about the environment of the
clients and servers supporting the Privacy Pass protocol.<a href="#section-3.3-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-2.1">At any one time, we assume that the server uses only one configuration
containing their ciphersuite choice along with their secret key data.
This ensures that all clients are issued tokens under the single key
associated with any given epoch.<a href="#section-3.3-2.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-3.3-2.2">We assume that the client has access to a global directory of the
current public parts of the configurations used the server.<a href="#section-3.3-2.2" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-3.3-3">The wider ecosystem that this protocol is employed in is described in
<span>[<a href="#draft-davidson-pp-architecture" class="xref">draft-davidson-pp-architecture</a>]</span>.<a href="#section-3.3-3" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-4">
      <h2 id="name-protocol-description">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-protocol-description" class="section-name selfRef">Protocol description</a>
      </h2>
<p id="section-4-1">The Privacy Pass protocol is split into two phases that are built upon
the functionality described in <a href="#pp-api" class="xref">Section 5</a> later.<a href="#section-4-1" class="pilcrow">Â¶</a></p>
<p id="section-4-2">The first phase, "issuance", provides the client with unlinkable tokens
that can be used to initiate re-authorization with the server in the
future. The second phase, "redemption", allows the client to redeem a
given re-authorization token with the server that it interacted with
during the issuance phase. The protocol must satisfy two cryptographic
security requirements known as "unlinkability" and "unforgeability".
These requirements are covered in <a href="#sec-reqs" class="xref">Section 6</a>.<a href="#section-4-2" class="pilcrow">Â¶</a></p>
<div id="server-setup">
<section id="section-4.1">
        <h3 id="name-server-setup">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-server-setup" class="section-name selfRef">Server setup</a>
        </h3>
<p id="section-4.1-1">Before the protocol takes place, the server chooses a ciphersuite and
generates a keypair by running <code>(pkS, skS) = KeyGen()</code>. This
configuration must be available to all clients that interact with the
server (for the purpose of engaging in a Privacy Pass exchange). We
assume that the server has a public (and unique) identity that the
client uses to retrieve this configuration.<a href="#section-4.1-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="client-setup">
<section id="section-4.2">
        <h3 id="name-client-setup">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-client-setup" class="section-name selfRef">Client setup</a>
        </h3>
<p id="section-4.2-1">The client initialises a global storage system <code>store</code> that allows it
store the tokens that are received during issuance. The storage system
is a map of server identifiers (<code>server.id</code>) to arrays of stored tokens.
We assume that the client knows the server public key <code>pkS</code> ahead of
time. The client picks a value <code>m</code> of tokens to receive during the
issuance phase. In <span>[<a href="#draft-davidson-pp-architecture" class="xref">draft-davidson-pp-architecture</a>]</span> we discuss
mechanisms that the client can use to ensure that this public key is
consistent across the entire ecosystem.<a href="#section-4.2-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="issuance-phase">
<section id="section-4.3">
        <h3 id="name-issuance-phase">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-issuance-phase" class="section-name selfRef">Issuance phase</a>
        </h3>
<p id="section-4.3-1">The issuance phase is a two-round protocol that allows the client to
receive <code>m</code> anonymous authorization tokens from the server. The first
round sees the server generate a commitment. The second round sees the
server issue a token to the client.<a href="#section-4.3-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-2">
<pre>
  Client(pkS, m, info)                        Server(skS, pkS)
  ------------------------------------------------------------

  commit_req = Prepare(info)

                           commit_req
                      -------------------&gt;

                    commit_resp = Commit(skS, pkS, commit_req)

                          commit_resp
                      &lt;-------------------

  cInput = Generate(m, commit_resp)
  req = cInput.req

                              req
                      -------------------&gt;

                              issueResp = Issue(pkS, skS, req)

                           serverResp
                      &lt;-------------------

  tokens = Process(pkS, cInput, serverResp)
  store[server.id].push(tokens)
</pre><a href="#section-4.3-2" class="pilcrow">Â¶</a>
</div>
<p id="section-4.3-3">Note that the first round of the protocol is only necessitated for
certain ciphersuites that require client and servers commit to some
value. When such commitment <code>commit_resp</code> is generated and sent to the
client, the client returns <code>commit_resp</code> with the <code>IssuanceRequest</code>
message. The server MUST check that the commitment corresponds to
<code>commit_resp</code> that was previously committed. This requires the
commitment to either be a reference to some commitment on the server, or
the commitment be an encrypted (and authenticated) blob that the server
can use to recover commitment. The mechanism by which servers handle
this commitment is implementation specific, and similar to how TLS
session resumption state is managed; see <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> for details. In
addition, the <code>Commit</code> function is implementation-specific and MUST be
defined by the underlying ciphersuite.<a href="#section-4.3-3" class="pilcrow">Â¶</a></p>
<p id="section-4.3-4">When the server does not need to generate this commitment, the client
instead DOES NOT send the <code>CommitRequest</code> message, and runs:<a href="#section-4.3-4" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-5">
<pre>
cInput = Generate(m, "")
</pre><a href="#section-4.3-5" class="pilcrow">Â¶</a>
</div>
<p id="section-4.3-6">A server that is expecting some non-empty <code>commit_resp</code> to be passed
must abort the protocol on receiving a request containing an empty
<code>commit_resp</code> value.<a href="#section-4.3-6" class="pilcrow">Â¶</a></p>
<p id="section-4.3-7">Note: currently, no ciphersuites are supported that support working with
empty commitment messages.<a href="#section-4.3-7" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="redemption-phase">
<section id="section-4.4">
        <h3 id="name-redemption-phase">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-redemption-phase" class="section-name selfRef">Redemption phase</a>
        </h3>
<p id="section-4.4-1">The redemption phase allows the client to anonymously reauthenticate to
the server, using data that it has received from a previous issuance
phase.<a href="#section-4.4-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-2">
<pre>
  Client(info)                                Server(skS, pkS)
  ------------------------------------------------------------
  token = store[server.id].pop()
  req = Redeem(token, info)

                               req
                        ------------------&gt;

                               if (dsIdx.includes(req.data)) {
                                 raise ERR_DOUBLE_SPEND
                               }
                               resp = Verify(pkS, skS, req)
                               if (resp.success) {
                                 dsIdx.push(req.data)
                               }

                                resp
                        &lt;------------------
  Output resp
</pre><a href="#section-4.4-2" class="pilcrow">Â¶</a>
</div>
<div id="client-info">
<section id="section-4.4.1">
          <h4 id="name-client-info">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-client-info" class="section-name selfRef">Client info</a>
          </h4>
<p id="section-4.4.1-1">The client input <code>info</code> is arbitrary byte data that is used for linking
the redemption request to the specific session. We RECOMMEND that <code>info</code>
is constructed as the following concatenated byte-encoded data:<a href="#section-4.4.1-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4.1-2">
<pre>
len(aux) || aux || len(server.id) || server.id || current_time()
</pre><a href="#section-4.4.1-2" class="pilcrow">Â¶</a>
</div>
<p id="section-4.4.1-3">where <code>len(x)</code> is the length of <code>x</code> in bytes, and <code>aux</code> is arbitrary
auxiliary data chosen by the client. The usage of <code>current_time()</code>
allows the server to check that the redemption request has happened in
an appropriate time window.<a href="#section-4.4.1-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="double-spend-protection">
<section id="section-4.4.2">
          <h4 id="name-double-spend-protection">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-double-spend-protection" class="section-name selfRef">Double-spend protection</a>
          </h4>
<p id="section-4.4.2-1">To protect against clients that attempt to spend a value <code>req.data</code> more
than once, the server uses an index, <code>dsIdx</code>, to collect valid inputs it
witnesses. Since this store needs to only be optimized for storage and
querying, a structure such as a Bloom filter suffices. The storage
should be parameterized to live as long as the server keypair that is in
use. See <a href="#sec-reqs" class="xref">Section 6</a> for more details.<a href="#section-4.4.2-1" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="handling-errors">
<section id="section-4.5">
        <h3 id="name-handling-errors">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-handling-errors" class="section-name selfRef">Handling errors</a>
        </h3>
<p id="section-4.5-1">It is possible for the API functions from <a href="#pp-functions" class="xref">Section 5.2</a> to return one
of the errors indicated in <a href="#errors" class="xref">Section 5.3</a> rather than their expected value.
In these cases, we assume that the entire protocol aborts.<a href="#section-4.5-1" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="pp-api">
<section id="section-5">
      <h2 id="name-functionality">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-functionality" class="section-name selfRef">Functionality</a>
      </h2>
<p id="section-5-1">This section details the data types and API functions that are used to
construct the protocol in <a href="#overview" class="xref">Section 4</a>.<a href="#section-5-1" class="pilcrow">Â¶</a></p>
<p id="section-5-2">We provide an explicit instantiation of the Privacy Pass API in
<a href="#voprf-api" class="xref">Section 7.3</a>, based on the public API provided in
<span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span>.<a href="#section-5-2" class="pilcrow">Â¶</a></p>
<div id="pp-structs">
<section id="section-5.1">
        <h3 id="name-data-structures">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-data-structures" class="section-name selfRef">Data structures</a>
        </h3>
<p id="section-5.1-1">The following data structures are used throughout the Privacy Pass
protocol and are written in the TLS presentation language <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.
It is intended that any of these data structures can be written into
widely-adopted encoding schemes such as those detailed in TLS
<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>, CBOR <span>[<a href="#RFC7049" class="xref">RFC7049</a>]</span>, and JSON <span>[<a href="#RFC7159" class="xref">RFC7159</a>]</span>.<a href="#section-5.1-1" class="pilcrow">Â¶</a></p>
<div id="pp-ciphersuite-struct">
<section id="section-5.1.1">
          <h4 id="name-ciphersuite">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-ciphersuite" class="section-name selfRef">Ciphersuite</a>
          </h4>
<p id="section-5.1.1-1">The <code>Ciphersuite</code> enum provides identifiers for each of the supported
ciphersuites of the protocol. Some initial values that are supported by
the core protocol are described in <a href="#pp-ciphersuites" class="xref">Section 8</a>. Note that the
list of supported ciphersuites may be expanded by extensions to the core
protocol description in separate documents.<a href="#section-5.1.1-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="pp-server-keys">
<section id="section-5.1.2">
          <h4 id="name-keys">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-keys" class="section-name selfRef">Keys</a>
          </h4>
<p id="section-5.1.2-1">We use the following types to describe the public and private keys used
by the server.<a href="#section-5.1.2-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.2-2">
<pre>
opaque PublicKey&lt;1..2^16-1&gt;
opaque PrivateKey&lt;1..2^16-1&gt;
</pre><a href="#section-5.1.2-2" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="pp-cli-commit-request">
<section id="section-5.1.3">
          <h4 id="name-commitrequest">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-commitrequest" class="section-name selfRef">CommitRequest</a>
          </h4>
<p id="section-5.1.3-1">The <code>CommitRequest</code> struct is simply a fixed message allowing opaque
metadata.<a href="#section-5.1.3-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.3-2">
<pre>
struct {
  opaque info&lt;1..2^16-1&gt;
} CommitRequest;
</pre><a href="#section-5.1.3-2" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="pp-cli-commit-response">
<section id="section-5.1.4">
          <h4 id="name-commitresponse">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-commitresponse" class="section-name selfRef">CommitResponse</a>
          </h4>
<p id="section-5.1.4-1">The <code>CommitResponse</code> struct is contains an opaque set of bytes that
correspond to some commitment that the server has generated. The
structure and format of this value is implementation specific depending
on whether the server is stateful.<a href="#section-5.1.4-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.4-2">
<pre>
struct {
  opaque commitment&lt;1..2^16-1&gt;
} CommitResponse;
</pre><a href="#section-5.1.4-2" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="pp-cli-issue-input">
<section id="section-5.1.5">
          <h4 id="name-issuanceinput">
<a href="#section-5.1.5" class="section-number selfRef">5.1.5. </a><a href="#name-issuanceinput" class="section-name selfRef">IssuanceInput</a>
          </h4>
<p id="section-5.1.5-1">The <code>IssuanceInput</code> struct describes the data that is initially
generated by the client during the issuance phase.<a href="#section-5.1.5-1" class="pilcrow">Â¶</a></p>
<p id="section-5.1.5-2">Firstly, we define sequences of bytes that partition the client input.<a href="#section-5.1.5-2" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.5-3">
<pre>
opaque Internal&lt;1..2^16-1&gt;
opaque IssuanceRequest&lt;1..2^16-1&gt;
</pre><a href="#section-5.1.5-3" class="pilcrow">Â¶</a>
</div>
<p id="section-5.1.5-4">These data types represent members of the wider <code>IssuanceInput</code> data
type.<a href="#section-5.1.5-4" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.5-5">
<pre>
struct {
  Internal data[data_bytes]
  IssuanceRequest req[req_bytes]
} IssuanceInput;
</pre><a href="#section-5.1.5-5" class="pilcrow">Â¶</a>
</div>
<p id="section-5.1.5-6">Note that a <code>IssuanceInput</code> contains equal-length size <code>m</code> arrays of
<code>Internal</code> and <code>IssuanceRequest</code> types corresponding to the number of
tokens that should be issued. <code>data_bytes</code> is the total number of bytes
that <code>m</code> <code>Internal</code> elements require, and <code>req_bytes</code> is the total
number of bytes that <code>m</code> <code>IssuanceRequest</code> elements require.<a href="#section-5.1.5-6" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="pp-srv-issue-response">
<section id="section-5.1.6">
          <h4 id="name-issuanceresponse">
<a href="#section-5.1.6" class="section-number selfRef">5.1.6. </a><a href="#name-issuanceresponse" class="section-name selfRef">IssuanceResponse</a>
          </h4>
<p id="section-5.1.6-1">Firstly, the <code>IssuedToken</code> type corresponds to a single sequence of
bytes that represents a single issued token received from the server.<a href="#section-5.1.6-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.6-2">
<pre>
opaque IssuedToken&lt;1..2^16-1&gt;
</pre><a href="#section-5.1.6-2" class="pilcrow">Â¶</a>
</div>
<p id="section-5.1.6-3">Then an <code>IssuanceResponse</code> corresponds to a collection of <code>IssuedTokens</code>
as well as a sequence of bytes <code>proof</code>.<a href="#section-5.1.6-3" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.6-4">
<pre>
struct {
  IssuedToken tokens[tokens_bytes]
  opaque proof&lt;1..2^16-1&gt;
}
</pre><a href="#section-5.1.6-4" class="pilcrow">Â¶</a>
</div>
<p id="section-5.1.6-5">The value of <code>m</code> is equal to the length of the <code>IssuanceRequest</code> vector
sent by the client. <code>tokens_bytes</code> is the total number of bytes that <code>m</code>
            <code>IssuedTokens</code> elements require.<a href="#section-5.1.6-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="pp-redemption-token">
<section id="section-5.1.7">
          <h4 id="name-redemptiontoken">
<a href="#section-5.1.7" class="section-number selfRef">5.1.7. </a><a href="#name-redemptiontoken" class="section-name selfRef">RedemptionToken</a>
          </h4>
<p id="section-5.1.7-1">The <code>RedemptionToken</code> struct contains the data required to generate the
client message in the redemption phase of the Privacy Pass protocol.<a href="#section-5.1.7-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.7-2">
<pre>
struct {
  opaque data&lt;1..2^16-1&gt;;
  opaque issued&lt;1..2^16-1&gt;;
} RedemptionToken;
</pre><a href="#section-5.1.7-2" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="pp-redemption-message">
<section id="section-5.1.8">
          <h4 id="name-redemptionrequest">
<a href="#section-5.1.8" class="section-number selfRef">5.1.8. </a><a href="#name-redemptionrequest" class="section-name selfRef">RedemptionRequest</a>
          </h4>
<p id="section-5.1.8-1">The <code>RedemptionRequest</code> struct consists of the data that is sent by the
client during the redemption phase of the protocol.<a href="#section-5.1.8-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.8-2">
<pre>
struct {
  opaque data&lt;1..2^16-1&gt;;
  opaque tag&lt;1..2^16-1&gt;;
  opaque info&lt;1..2^16-1&gt;;
} RedemptionRequest;
</pre><a href="#section-5.1.8-2" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="pp-redemption-response">
<section id="section-5.1.9">
          <h4 id="name-redemptionresponse">
<a href="#section-5.1.9" class="section-number selfRef">5.1.9. </a><a href="#name-redemptionresponse" class="section-name selfRef">RedemptionResponse</a>
          </h4>
<p id="section-5.1.9-1">The <code>RedemptionResponse</code> struct corresponds to a boolean value that
indicates whether the <code>RedemptionRequest</code> sent by the client is valid.
It can also contain any associated data.<a href="#section-5.1.9-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1.9-2">
<pre>
struct {
  boolean success;
  opaque ad&lt;1..2^16-1&gt;;
} RedemptionResponse;
</pre><a href="#section-5.1.9-2" class="pilcrow">Â¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="pp-functions">
<section id="section-5.2">
        <h3 id="name-api-functions">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-api-functions" class="section-name selfRef">API functions</a>
        </h3>
<p id="section-5.2-1">The following functions wrap the core of the functionality required in
the Privacy Pass protocol. For each of the descriptions, we essentially
provide the function signature, leaving the actual contents to be
defined by specific instantiations or extensions of the protocol.<a href="#section-5.2-1" class="pilcrow">Â¶</a></p>
<div id="prepare">
<section id="section-5.2.1">
          <h4 id="name-prepare">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-prepare" class="section-name selfRef">Prepare</a>
          </h4>
<p id="section-5.2.1-1">A function run by the client to prepare for a commitment will used
during the issuance flow of the Privacy Pass protocol.<a href="#section-5.2.1-1" class="pilcrow">Â¶</a></p>
<p id="section-5.2.1-2">Inputs:<a href="#section-5.2.1-2" class="pilcrow">Â¶</a></p>
<p id="section-5.2.1-3"><code>info</code>: An opaque byte application-specific byte string.<a href="#section-5.2.1-3" class="pilcrow">Â¶</a></p>
<p id="section-5.2.1-4">Outputs:<a href="#section-5.2.1-4" class="pilcrow">Â¶</a></p>
<p id="section-5.2.1-5"><code>commit_req</code>: A <code>CommitRequest</code> struct.<a href="#section-5.2.1-5" class="pilcrow">Â¶</a></p>
<p id="section-5.2.1-6">This function should be implemented by any ciphersuites that require a
two-phase issuance protocol (<code>COMMIT=true</code>).<a href="#section-5.2.1-6" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="commit">
<section id="section-5.2.2">
          <h4 id="name-commit">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-commit" class="section-name selfRef">Commit</a>
          </h4>
<p id="section-5.2.2-1">A function run by the server that generates a commitment in the first
phase of the issuance protocol.<a href="#section-5.2.2-1" class="pilcrow">Â¶</a></p>
<p id="section-5.2.2-2">Inputs:<a href="#section-5.2.2-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-3.1">
              <code>skS</code>: A server <code>PrivateKey</code>.<a href="#section-5.2.2-3.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-5.2.2-3.2">
              <code>pkS</code>: A server <code>PublicKey</code>.<a href="#section-5.2.2-3.2" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-5.2.2-3.3">
              <code>commit_req</code>: A <code>CommitRequest</code> struct<a href="#section-5.2.2-3.3" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-5.2.2-4">Outputs:<a href="#section-5.2.2-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-5.1">
              <code>commit_resp</code>: A <code>CommitResponse</code> struct.<a href="#section-5.2.2-5.1" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-5.2.2-6">This function should be implemented by any ciphersuites that require a
two-phase issuance protocol (<code>COMMIT=true</code>).<a href="#section-5.2.2-6" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="generate">
<section id="section-5.2.3">
          <h4 id="name-generate">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-generate" class="section-name selfRef">Generate</a>
          </h4>
<p id="section-5.2.3-1">A function run by the client to generate the initial data that is used
as its input in the Privacy Pass protocol.<a href="#section-5.2.3-1" class="pilcrow">Â¶</a></p>
<p id="section-5.2.3-2">Inputs:<a href="#section-5.2.3-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3-3.1">
              <code>m</code>:       A <code>uint8</code> value corresponding to the number of Privacy Pass
           tokens to generate.<a href="#section-5.2.3-3.1" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-5.2.3-4">Outputs:<a href="#section-5.2.3-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3-5.1">
              <code>input</code>: An <code>IssuanceInput</code> struct.<a href="#section-5.2.3-5.1" class="pilcrow">Â¶</a>
</li>
          </ul>
</section>
</div>
<div id="issue">
<section id="section-5.2.4">
          <h4 id="name-issue">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-issue" class="section-name selfRef">Issue</a>
          </h4>
<p id="section-5.2.4-1">A function run by the server to issue valid redemption tokens to the
client.<a href="#section-5.2.4-1" class="pilcrow">Â¶</a></p>
<p id="section-5.2.4-2">Inputs:<a href="#section-5.2.4-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.4-3.1">
              <code>pkS</code>: A server <code>PublicKey</code>.<a href="#section-5.2.4-3.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-5.2.4-3.2">
              <code>skS</code>: A server <code>PrivateKey</code>.<a href="#section-5.2.4-3.2" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-5.2.4-3.3">
              <code>req</code>: An <code>IssuanceRequest</code> struct.<a href="#section-5.2.4-3.3" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-5.2.4-4">Outputs:<a href="#section-5.2.4-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.4-5.1">
              <code>resp</code>: An <code>IssuanceResponse</code> struct.<a href="#section-5.2.4-5.1" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-5.2.4-6">Throws:<a href="#section-5.2.4-6" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.4-7.1">
              <code>ERR_FAILED_COMMITMENT</code> (<a href="#errors" class="xref">Section 5.3</a>)<a href="#section-5.2.4-7.1" class="pilcrow">Â¶</a>
</li>
          </ul>
</section>
</div>
<div id="process">
<section id="section-5.2.5">
          <h4 id="name-process">
<a href="#section-5.2.5" class="section-number selfRef">5.2.5. </a><a href="#name-process" class="section-name selfRef">Process</a>
          </h4>
<p id="section-5.2.5-1">Run by the client when processing the server response in the issuance
phase of the protocol.<a href="#section-5.2.5-1" class="pilcrow">Â¶</a></p>
<p id="section-5.2.5-2">Inputs:<a href="#section-5.2.5-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.5-3.1">
              <code>pkS</code>: An server <code>PublicKey</code>.<a href="#section-5.2.5-3.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-5.2.5-3.2">
              <code>input</code>: An <code>IssuanceInput</code> struct.<a href="#section-5.2.5-3.2" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-5.2.5-3.3">
              <code>resp</code>: An <code>IssuanceResponse</code> struct.<a href="#section-5.2.5-3.3" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-5.2.5-4">Outputs:<a href="#section-5.2.5-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.5-5.1">
              <code>tokens</code>: A vector of <code>RedemptionToken</code> structs, whose length is equal
to length of the internal <code>ServerEvaluation</code> vector in the
<code>IssuanceResponse</code> struct.<a href="#section-5.2.5-5.1" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-5.2.5-6">Throws:<a href="#section-5.2.5-6" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.5-7.1">
              <code>ERR_PROOF_VALIDATION</code> (<a href="#errors" class="xref">Section 5.3</a>)<a href="#section-5.2.5-7.1" class="pilcrow">Â¶</a>
</li>
          </ul>
</section>
</div>
<div id="redeem">
<section id="section-5.2.6">
          <h4 id="name-redeem">
<a href="#section-5.2.6" class="section-number selfRef">5.2.6. </a><a href="#name-redeem" class="section-name selfRef">Redeem</a>
          </h4>
<p id="section-5.2.6-1">Run by the client in the redemption phase of the protocol to generate
the client's message.<a href="#section-5.2.6-1" class="pilcrow">Â¶</a></p>
<p id="section-5.2.6-2">Inputs:<a href="#section-5.2.6-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.6-3.1">
              <code>token</code>: A <code>RedemptionToken</code> struct.<a href="#section-5.2.6-3.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-5.2.6-3.2">
              <code>info</code>: An <code>opaque&lt;1..2^16-1&gt;</code> type corresponding to data that is
linked to the redemption. See <a href="#client-info" class="xref">Section 4.4.1</a> for advice on how to
construct this.<a href="#section-5.2.6-3.2" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-5.2.6-4">Outputs:<a href="#section-5.2.6-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.6-5.1">
              <code>req</code>: A <code>RedemptionRequest</code> struct.<a href="#section-5.2.6-5.1" class="pilcrow">Â¶</a>
</li>
          </ul>
</section>
</div>
<div id="verify">
<section id="section-5.2.7">
          <h4 id="name-verify">
<a href="#section-5.2.7" class="section-number selfRef">5.2.7. </a><a href="#name-verify" class="section-name selfRef">Verify</a>
          </h4>
<p id="section-5.2.7-1">Run by the server in the redemption phase of the protocol. Determines
whether the data sent by the client is valid.<a href="#section-5.2.7-1" class="pilcrow">Â¶</a></p>
<p id="section-5.2.7-2">Inputs:<a href="#section-5.2.7-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.7-3.1">
              <code>pkS</code>: An server <code>PublicKey</code>.<a href="#section-5.2.7-3.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-5.2.7-3.2">
              <code>skS</code>: An server <code>PrivateKey</code>.<a href="#section-5.2.7-3.2" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="section-5.2.7-3.3">
              <code>req</code>: A <code>RedemptionRequest</code> struct.<a href="#section-5.2.7-3.3" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="section-5.2.7-4">Outputs:<a href="#section-5.2.7-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.7-5.1">
              <code>resp</code>: A <code>RedemptionResponse</code> struct.<a href="#section-5.2.7-5.1" class="pilcrow">Â¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="errors">
<section id="section-5.3">
        <h3 id="name-error-types">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-error-types" class="section-name selfRef">Error types</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-5.3-1.1">
            <code>ERR_PROOF_VALIDATION</code>: Error occurred when a client attempted to
verify the proof that is part of the server's response.<a href="#section-5.3-1.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-5.3-1.2">
            <code>ERR_DOUBLE_SPEND</code>: Error occurred when a client has attempted to
redeem a token that has already been used for authorization.<a href="#section-5.3-1.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-5.3-1.3">
            <code>ERR_FAILED_COMMITMENT</code>: Error occurs during issuance phase if
non-empty commitment does not match the commitment generated in the
first round.<a href="#section-5.3-1.3" class="pilcrow">Â¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-reqs">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security considerations</a>
      </h2>
<p id="section-6-1">We discuss the security requirements that are necessary to uphold when
instantiating the Privacy Pass protocol. In particular, we focus on the
security requirements of "unlinkability", and "unforgeability".
Informally, the notion of unlinkability is required to preserve the
anonymity of the client in the redemption phase of the protocol. The
notion of unforgeability is to protect against an adversarial client
that may look to subvert the security of the protocol.<a href="#section-6-1" class="pilcrow">Â¶</a></p>
<p id="section-6-2">Both requirements are modelled as typical cryptographic security games,
following the formats laid out in <span>[<a href="#DGSTV18" class="xref">DGSTV18</a>]</span> and <span>[<a href="#KLOR20" class="xref">KLOR20</a>]</span>.<a href="#section-6-2" class="pilcrow">Â¶</a></p>
<p id="section-6-3">Note that the privacy requirements of the protocol are covered in the
architectural framework document <span>[<a href="#draft-davidson-pp-architecture" class="xref">draft-davidson-pp-architecture</a>]</span>.<a href="#section-6-3" class="pilcrow">Â¶</a></p>
<div id="unlinkability">
<section id="section-6.1">
        <h3 id="name-unlinkability">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-unlinkability" class="section-name selfRef">Unlinkability</a>
        </h3>
<p id="section-6.1-1">Formally speaking the security model is the following:<a href="#section-6.1-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">The adversary runs the server setup and generates a keypair <code>(pkS,
skS)</code>.<a href="#section-6.1-2.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.1-2.2">The adversary specifies a number <code>Q</code> of issuance phases to initiate,
where each phase <code>i in range(Q)</code> consists of <code>m_i</code> Issue evaluations.<a href="#section-6.1-2.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.1-2.3">The adversary runs <code>Issue</code> using the keypair that it generated on each
of the client messages in the issuance phase.<a href="#section-6.1-2.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.1-2.4">When the adversary wants, it stops the issuance phase, and a random
number <code>l</code> is picked from <code>range(Q)</code>.<a href="#section-6.1-2.4" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.1-2.5">A redemption phase is initiated with a single token with index <code>i</code>
randomly sampled from <code>range(m_l)</code>.<a href="#section-6.1-2.5" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.1-2.6">The adversary guesses an index <code>l_guess</code> corresponding to the index of
the issuance phase that it believes the redemption token was received
in.<a href="#section-6.1-2.6" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.1-2.7">The adversary succeeds if <code>l == l_guess</code>.<a href="#section-6.1-2.7" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-6.1-3">The security requirement is that the adversary has only a negligible
probability of success greater than <code>1/Q</code>.<a href="#section-6.1-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="unforgeability">
<section id="section-6.2">
        <h3 id="name-one-more-unforgeability">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-one-more-unforgeability" class="section-name selfRef">One-more unforgeability</a>
        </h3>
<p id="section-6.2-1">The one-more unforgeability requirement states that it is hard for any
adversarial client that has received <code>m</code> valid tokens from the issuance
phase to redeem <code>m+1</code> of them. In essence, this requirement prevents a
malicious client from being able to forge valid tokens based on the
Issue responses that it sees.<a href="#section-6.2-1" class="pilcrow">Â¶</a></p>
<p id="section-6.2-2">The security model roughly takes the following form:<a href="#section-6.2-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-3.1">The adversary specifies a number <code>Q</code> of issuance phases to initiate
with the server, where each phase <code>i in range(Q)</code> consists of <code>m_i</code>
server evaluation. Let <code>m = sum(m_i)</code> where <code>i in range(Q)</code>.<a href="#section-6.2-3.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.2-3.2">The adversary receives <code>Q</code> responses, where the response with index
<code>i</code> contains <code>m_i</code> individual tokens.<a href="#section-6.2-3.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.2-3.3">The adversary initiates <code>m_adv</code> redemption sessions with the server
and the server verifies that the sessions are successful (return
true), and that each request includes a unique token. The adversary
succeeds in <code>m_succ =&lt; m_adv</code> redemption sessions.<a href="#section-6.2-3.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-6.2-3.4">The adversary succeeds if <code>m_succ &gt; m</code>.<a href="#section-6.2-3.4" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-6.2-4">The security requirement is that the adversarial client has only a
negligible probability of succeeding.<a href="#section-6.2-4" class="pilcrow">Â¶</a></p>
<p id="section-6.2-5">Note that <span>[<a href="#KLOR20" class="xref">KLOR20</a>]</span> strengthens the capabilities of the adversary, in
comparison to the original work of <span>[<a href="#DGSTV18" class="xref">DGSTV18</a>]</span>. In <span>[<a href="#KLOR20" class="xref">KLOR20</a>]</span>, the
adversary is provided with oracle access that allows it to verify that
the server responses in the issuance phase are valid.<a href="#section-6.2-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="double-spend-protection-1">
<section id="section-6.3">
        <h3 id="name-double-spend-protection-2">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-double-spend-protection-2" class="section-name selfRef">Double-spend protection</a>
        </h3>
<p id="section-6.3-1">All issuing servers should implement a robust, global storage-query
mechanism for checking that tokens sent by clients have not been spent
before. Such tokens only need to be checked for each server
individually. This prevents clients from "replaying" previous requests,
and is necessary for achieving the unforgeability requirement.<a href="#section-6.3-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="additional-token-metadata">
<section id="section-6.4">
        <h3 id="name-additional-token-metadata">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-additional-token-metadata" class="section-name selfRef">Additional token metadata</a>
        </h3>
<p id="section-6.4-1">Some use-cases of the Privacy Pass protocol benefit from associating a
limited amount of metadata with tokens that can be read by the server
when a token is redeemed. Adding metadata to tokens can be used as a
vector to segment the anonymity of the client in the protocol.
Therefore, it is important that any metadata that is added is heavily
limited.<a href="#section-6.4-1" class="pilcrow">Â¶</a></p>
<p id="section-6.4-2">Any additional metadata that can be added to redemption tokens should be
described in the specific protocol instantiation. Note that any
additional metadata will have to be justified in light of the privacy
concerns raised above. For more details on the impacts associated with
segmenting user privacy, see <span>[<a href="#draft-davidson-pp-architecture" class="xref">draft-davidson-pp-architecture</a>]</span>.<a href="#section-6.4-2" class="pilcrow">Â¶</a></p>
<p id="section-6.4-3">Any metadata added to tokens will be considered either "public" or
"private". Public metadata corresponds to unmodifiable bits that a
client can read. Private metadata corresponds to unmodifiable private
bits that should be obscured to the client.<a href="#section-6.4-3" class="pilcrow">Â¶</a></p>
<p id="section-6.4-4">Note that the instantiation in <a href="#voprf-protocol" class="xref">Section 7</a> provides randomized
redemption tokens with no additional metadata for an server with a
single key.<a href="#section-6.4-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="max-tokens">
<section id="section-6.5">
        <h3 id="name-maximum-number-of-tokens-is">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-maximum-number-of-tokens-is" class="section-name selfRef">Maximum number of tokens issued</a>
        </h3>
<p id="section-6.5-1">Servers SHOULD impose a hard ceiling on the number of tokens that can be
issued in a single issuance phase to a client. If there is no limit,
malicious clients could abuse this and cause excessive computation,
leading to a Denial-of-Service attack.<a href="#section-6.5-1" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="voprf-protocol">
<section id="section-7">
      <h2 id="name-voprf-instantiation">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-voprf-instantiation" class="section-name selfRef">VOPRF instantiation</a>
      </h2>
<p id="section-7-1">In this section, we show how to instantiate the functional API in
<a href="#pp-api" class="xref">Section 5</a> with the VOPRF protocol described in <span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span>.
Moreover, we show that this protocol satisfies the security requirements
laid out in <a href="#sec-reqs" class="xref">Section 6</a>, based on the security proofs provided in
<span>[<a href="#DGSTV18" class="xref">DGSTV18</a>]</span> and <span>[<a href="#KLOR20" class="xref">KLOR20</a>]</span>.<a href="#section-7-1" class="pilcrow">Â¶</a></p>
<div id="voprf-ciph-recs">
<section id="section-7.1">
        <h3 id="name-recommended-ciphersuites">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-recommended-ciphersuites" class="section-name selfRef">Recommended ciphersuites</a>
        </h3>
<p id="section-7.1-1">The RECOMMENDED server ciphersuites are as follows: detailed in
<span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span>:<a href="#section-7.1-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.1">OPRF(decaf448, SHA-512) (ID = 0x0002);<a href="#section-7.1-2.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-7.1-2.2">OPRF(P-384, SHA-512) (ID = 0x0004);<a href="#section-7.1-2.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-7.1-2.3">OPRF(P-521, SHA-512) (ID = 0x0005).<a href="#section-7.1-2.3" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-7.1-3">We deliberately avoid the usage of smaller ciphersuites (associated with
P-256 and ristretto255) due to the potential to reduce security to
unfavourable levels via static Diffie Hellman attacks. See
<span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span> for more details.<a href="#section-7.1-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="protocol-contexts">
<section id="section-7.2">
        <h3 id="name-protocol-contexts">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-protocol-contexts" class="section-name selfRef">Protocol contexts</a>
        </h3>
<p id="section-7.2-1">Note that we must run the verifiable version of the protocol in
<span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span>. Therefore the <code>server</code> takes the role of the
<code>Server</code> running in <code>modeVerifiable</code>. In other words, the <code>server</code> runs
<code>ctxtS = SetupVerifiableServer(suite, skS, pkS)</code>; where <code>suite</code> is one
of the ciphersuites in <a href="#voprf-ciph-recs" class="xref">Section 7.1</a>, <code>skS</code> and <code>pkS</code> is the
server's secret and public key respectively (generated by calling
<code>KeyGen</code>). It returns <code>ctxtS</code>, which is the Server context. Likewise,
run <code>ctxtC = SetupVerifiableClient(suite, pkS)</code> to generate the Client
context.<a href="#section-7.2-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="voprf-api">
<section id="section-7.3">
        <h3 id="name-functionality-2">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-functionality-2" class="section-name selfRef">Functionality</a>
        </h3>
<p id="section-7.3-1">We instantiate each functions using the API functions in
<span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span>. Note that we use the framework mentioned in the
document to allow for batching multiple tokens into a single VOPRF
evaluation. For the explicit signatures of each of the functions, refer
to <a href="#pp-api" class="xref">Section 5</a>.<a href="#section-7.3-1" class="pilcrow">Â¶</a></p>
<div id="generate-1">
<section id="section-7.3.1">
          <h4 id="name-generate-2">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-generate-2" class="section-name selfRef">Generate</a>
          </h4>
<p id="section-7.3.1-1">The generate functionality generates an initial set of tokens and
blinded representation on the client-side. The function also takes an
optional (possibly empty) value for a commitment <code>com</code> committed to by
the server.<a href="#section-7.3.1-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.1-2">
<pre>
def Generate(m, com):
  tokens = []
  blindedTokens = []
  for i in range(m):
    x = random_bytes()
    (token, blindedToken) = Blind(x, com)
    tokens[i] = token
    blindedTokens[i] = blindedToken
  return IssuanceInput {
           data: tokens,
           req: blindedTokens,
         }
</pre><a href="#section-7.3.1-2" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="issue-1">
<section id="section-7.3.2">
          <h4 id="name-issue-2">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-issue-2" class="section-name selfRef">Issue</a>
          </h4>
<p id="section-7.3.2-1">For this functionality, note that we supply multiple tokens in <code>req</code> to
<code>Evaluate</code>. This allows batching a single proof object for multiple
evaluations. While the construction in <span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span> only
permits a single input, we follow the advice for providing vectors of
inputs.<a href="#section-7.3.2-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.2-2">
<pre>
def Issue(pkS, skS, req):
  elements, proof = Evaluate(skS, pkS, req)
  return IssuanceResponse {
           tokens: elements,
           proof: proof,
         }
</pre><a href="#section-7.3.2-2" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="process-1">
<section id="section-7.3.3">
          <h4 id="name-process-2">
<a href="#section-7.3.3" class="section-number selfRef">7.3.3. </a><a href="#name-process-2" class="section-name selfRef">Process</a>
          </h4>
<p id="section-7.3.3-1">Similarly to <code>Issue</code>, we follow the advice for providing vectors of
inputs to the <code>Unblind</code> function for verifying the batched proof object.<a href="#section-7.3.3-1" class="pilcrow">Â¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.3.3-2">
<pre>
Process(pkS, input, resp):
  unblindedTokens = Unblind(input.data, resp.elements,
                              input.req, pkS, resp.proof)
  redemptionTokens = []
  for bt in unblindedTokens:
    rt = RedemptionToken { data: input.data, issued: bt }
    redemptionTokens[i] = rt
  return redemptionTokens
</pre><a href="#section-7.3.3-2" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="redeem-1">
<section id="section-7.3.4">
          <h4 id="name-redeem-2">
<a href="#section-7.3.4" class="section-number selfRef">7.3.4. </a><a href="#name-redeem-2" class="section-name selfRef">Redeem</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-7.3.4-1">
<pre>
def Redeem(token, info):
  tag = Finalize(token.data, token.issued, info)
  return RedemptionRequest {
           data: data,
           tag: tag,
           info: info,
         }
</pre><a href="#section-7.3.4-1" class="pilcrow">Â¶</a>
</div>
</section>
</div>
<div id="verify-1">
<section id="section-7.3.5">
          <h4 id="name-verify-2">
<a href="#section-7.3.5" class="section-number selfRef">7.3.5. </a><a href="#name-verify-2" class="section-name selfRef">Verify</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-7.3.5-1">
<pre>
def Verify(pkS, skS, req):
  resp = VerifyFinalize(skS, req.data, req.info, req.tag)
  Output RedemptionResponse {
           success: resp
         }
</pre><a href="#section-7.3.5-1" class="pilcrow">Â¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="security-justification">
<section id="section-7.4">
        <h3 id="name-security-justification">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-security-justification" class="section-name selfRef">Security justification</a>
        </h3>
<p id="section-7.4-1">The protocol devised in <a href="#overview" class="xref">Section 4</a>, coupled with the API instantiation
in <a href="#voprf-api" class="xref">Section 7.3</a>, are equivalent to the protocol description in
<span>[<a href="#DGSTV18" class="xref">DGSTV18</a>]</span> and <span>[<a href="#KLOR20" class="xref">KLOR20</a>]</span> from a security perspective. In <span>[<a href="#DGSTV18" class="xref">DGSTV18</a>]</span>,
it is proven that this protocol satisfies the security requirements of
unlinkability (<a href="#unlinkability" class="xref">Section 6.1</a>) and unforgeability
(<a href="#unforgeability" class="xref">Section 6.2</a>).<a href="#section-7.4-1" class="pilcrow">Â¶</a></p>
<p id="section-7.4-2">The unlinkability property follows unconditionally as the view of the
adversary in the redemption phase is distributed independently of the
issuance phase. The unforgeability property follows from the one-more
decryption security of the ElGamal cryptosystem <span>[<a href="#DGSTV18" class="xref">DGSTV18</a>]</span>. In
<span>[<a href="#KLOR20" class="xref">KLOR20</a>]</span> it is also proven that this protocol satisfies the stronger
notion of unforgeability, where the adversary is granted a verification
oracle, under the chosen-target Diffie-Hellman assumption.<a href="#section-7.4-2" class="pilcrow">Â¶</a></p>
<p id="section-7.4-3">Note that the existing security proofs do not leverage the VOPRF
primitive as a black-box in the security reductions. Instead, it relies
on the underlying operations in a non-black-box manner. Hence, an
explicit reduction from the generic VOPRF primitive to the Privacy Pass
protocol would strengthen these security guarantees.<a href="#section-7.4-3" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="pp-ciphersuites">
<section id="section-8">
      <h2 id="name-protocol-ciphersuites">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-protocol-ciphersuites" class="section-name selfRef">Protocol ciphersuites</a>
      </h2>
<p id="section-8-1">The ciphersuites that we describe for the Privacy Pass protocol are
derived from the core instantiations of the protocol (such as in
<a href="#voprf-protocol" class="xref">Section 7</a>).<a href="#section-8-1" class="pilcrow">Â¶</a></p>
<p id="section-8-2">In each of the ciphersuites below, the maximum security provided
corresponds to the maximum difficulty of computing a discrete logarithm
in the group. Note that the actual security level MAY be lower. See the
security considerations in <span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span> for examples.<a href="#section-8-2" class="pilcrow">Â¶</a></p>
<p id="section-8-3">The COMMIT parameter refers to whether the first round of the issuance
phase of the protocol is necessary. When this is false, the client
ignores the first message and uses an empty value for the commitment
parameter to <code>Generate</code>.<a href="#section-8-3" class="pilcrow">Â¶</a></p>
<div id="ppoprf2">
<section id="section-8.1">
        <h3 id="name-ppoprf2">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-ppoprf2" class="section-name selfRef">PP(OPRF2)</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-8.1-1.1">OPRF2 = OPRF(decaf448, SHA-512)<a href="#section-8.1-1.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-8.1-1.2">ID = 0x0001<a href="#section-8.1-1.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-8.1-1.3">COMMIT = false<a href="#section-8.1-1.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-8.1-1.4">Maximum security provided: 224 bits<a href="#section-8.1-1.4" class="pilcrow">Â¶</a>
</li>
        </ul>
</section>
</div>
<div id="ppoprf4">
<section id="section-8.2">
        <h3 id="name-ppoprf4">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-ppoprf4" class="section-name selfRef">PP(OPRF4)</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-8.2-1.1">OPRF4 = OPRF(P-384, SHA-512)<a href="#section-8.2-1.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-8.2-1.2">ID = 0x0002<a href="#section-8.2-1.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-8.2-1.3">COMMIT = false<a href="#section-8.2-1.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-8.2-1.4">Maximum security provided: 192 bits<a href="#section-8.2-1.4" class="pilcrow">Â¶</a>
</li>
        </ul>
</section>
</div>
<div id="ppoprf5">
<section id="section-8.3">
        <h3 id="name-ppoprf5">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-ppoprf5" class="section-name selfRef">PP(OPRF5)</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-8.3-1.1">OPRF5 = OPRF(P-521, SHA-512)<a href="#section-8.3-1.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-8.3-1.2">ID = 0x0003<a href="#section-8.3-1.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-8.3-1.3">COMMIT = false<a href="#section-8.3-1.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-8.3-1.4">Maximum security provided: 256 bits<a href="#section-8.3-1.4" class="pilcrow">Â¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="extensions">
<section id="section-9">
      <h2 id="name-extensions-framework-policy">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-extensions-framework-policy" class="section-name selfRef">Extensions framework policy</a>
      </h2>
<p id="section-9-1">The intention with providing the Privacy Pass API in <a href="#pp-api" class="xref">Section 5</a> is to
allow new instantiations of the Privacy Pass protocol. These
instantiations may provide either modified VOPRF constructions, or
simply implement the API in a completely different way.<a href="#section-9-1" class="pilcrow">Â¶</a></p>
<p id="section-9-2">Extensions to this initial draft SHOULD be specified as separate
documents taking one of two possible routes:<a href="#section-9-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-3.1">Produce new VOPRF-like primitives that use the same public API
provided in <span>[<a href="#I-D.irtf-cfrg-voprf" class="xref">I-D.irtf-cfrg-voprf</a>]</span> to implement the Privacy Pass API,
but with different internal operations.<a href="#section-9-3.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="section-9-3.2">Implement the Privacy Pass API in a different way to the proposed
implementation in <a href="#voprf-protocol" class="xref">Section 7</a>.<a href="#section-9-3.2" class="pilcrow">Â¶</a>
</li>
      </ul>
<p id="section-9-4">If an extension requires changing the generic protocol description as
described in <a href="#overview" class="xref">Section 4</a>, then the change may have to result in changes
to the draft specification here also.<a href="#section-9-4" class="pilcrow">Â¶</a></p>
<p id="section-9-5">Each new extension that modifies the internals of the protocol in either
of the two ways MUST re-justify that the extended protocol still
satisfies the security requirements in <a href="#sec-reqs" class="xref">Section 6</a>. Protocol extensions
MAY put forward new security guarantees if they are applicable.<a href="#section-9-5" class="pilcrow">Â¶</a></p>
<p id="section-9-6">The extensions MUST also conform with the extension framework policy as
set out in the architectural framework document. For example, this may
concern any potential impact on client anonymity that the extension may
introduce.<a href="#section-9-6" class="pilcrow">Â¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="draft-davidson-pp-architecture">[draft-davidson-pp-architecture]</dt>
        <dd>
<span class="refAuthor">Davidson, A.</span>, <span class="refTitle">"Privacy Pass: Architectural Framework"</span>, <span>n.d.</span>, <span>&lt;<a href="https://github.com/alxdavids/privacy-pass-ietf/tree/master/drafts/draft-davidson-pp-architecture">https://github.com/alxdavids/privacy-pass-ietf/tree/master/drafts/draft-davidson-pp-architecture</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="draft-svaldez-pp-http-api">[draft-svaldez-pp-http-api]</dt>
        <dd>
<span class="refAuthor">Valdez, S.</span>, <span class="refTitle">"Privacy Pass: HTTP API"</span>, <span>n.d.</span>, <span>&lt;<a href="https://github.com/alxdavids/privacy-pass-ietf/tree/master/drafts/draft-davidson-pp-architecture">https://github.com/alxdavids/privacy-pass-ietf/tree/master/drafts/draft-davidson-pp-architecture</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-voprf">[I-D.irtf-cfrg-voprf]</dt>
        <dd>
<span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Oblivious Pseudorandom Functions (OPRFs) using Prime-Order Groups"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-voprf-08</span>, <time datetime="2021-10-25" class="refDate">25 October 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-voprf-08">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-voprf-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Brave">[Brave]</dt>
        <dd>
<span class="refTitle">"Brave Rewards"</span>, <span>n.d.</span>, <span>&lt;<a href="https://brave.com/brave-rewards/">https://brave.com/brave-rewards/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DGSTV18">[DGSTV18]</dt>
        <dd>
<span class="refTitle">"Privacy Pass, Bypassing Internet Challenges Anonymously"</span>, <span>n.d.</span>, <span>&lt;<a href="https://petsymposium.org/2018/files/papers/issue3/popets-2018-0026.pdf">https://petsymposium.org/2018/files/papers/issue3/popets-2018-0026.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KLOR20">[KLOR20]</dt>
        <dd>
<span class="refTitle">"Anonymous Tokens with Private Metadata Bit"</span>, <span>n.d.</span>, <span>&lt;<a href="https://eprint.iacr.org/2020/072">https://eprint.iacr.org/2020/072</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OpenPrivacy">[OpenPrivacy]</dt>
        <dd>
<span class="refTitle">"Token Based Services - Differences from PrivacyPass"</span>, <span>n.d.</span>, <span>&lt;<a href="https://openprivacy.ca/assets/towards-anonymous-prepaid-services.pdf">https://openprivacy.ca/assets/towards-anonymous-prepaid-services.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PrivateStorage">[PrivateStorage]</dt>
        <dd>
<span class="refAuthor">Steininger, L.</span>, <span class="refTitle">"The Path from S4 to PrivateStorage"</span>, <span>n.d.</span>, <span>&lt;<a href="https://medium.com/least-authority/the-path-from-s4-to-privatestorage-ae9d4a10b2ae">https://medium.com/least-authority/the-path-from-s4-to-privatestorage-ae9d4a10b2ae</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7049">[RFC7049]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 7049</span>, <span class="seriesInfo">DOI 10.17487/RFC7049</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7049">https://www.rfc-editor.org/rfc/rfc7049</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7159">[RFC7159]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">RFC 7159</span>, <span class="seriesInfo">DOI 10.17487/RFC7159</span>, <time datetime="2014-03" class="refDate">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7159">https://www.rfc-editor.org/rfc/rfc7159</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TrustTokenAPI">[TrustTokenAPI]</dt>
      <dd>
<span class="refAuthor">WICG, .</span>, <span class="refTitle">"Trust Token API"</span>, <span>n.d.</span>, <span>&lt;<a href="https://github.com/WICG/trust-token-api">https://github.com/WICG/trust-token-api</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="document-contributors">
<section id="appendix-A">
      <h2 id="name-document-contributors">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-document-contributors" class="section-name selfRef">Document contributors</a>
      </h2>
<ul class="normal">
<li class="normal" id="appendix-A-1.1">Alex Davidson (alex.davidson92@gmail.com)<a href="#appendix-A-1.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="appendix-A-1.2">Sofia Celi (cherenkov@riseup.net)<a href="#appendix-A-1.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="appendix-A-1.3">Christopher Wood (caw@heapingbits.net)<a href="#appendix-A-1.3" class="pilcrow">Â¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">SofÃ­a Celi</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div dir="auto" class="left"><span class="locality">Lisbon</span></div>
<div dir="auto" class="left"><span class="country-name">Portugal</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sceli@cloudflare.com" class="email">sceli@cloudflare.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Alex Davidson</span></div>
<div dir="auto" class="left"><span class="org">LIP</span></div>
<div dir="auto" class="left"><span class="locality">Lisbon</span></div>
<div dir="auto" class="left"><span class="country-name">Portugal</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:alex.davidson92@gmail.com" class="email">alex.davidson92@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Armando Faz-Hernandez</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div dir="auto" class="left"><span class="street-address">101 Townsend St</span></div>
<div dir="auto" class="left">
<span class="locality">San Francisco</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:armfazh@cloudflare.com" class="email">armfazh@cloudflare.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
